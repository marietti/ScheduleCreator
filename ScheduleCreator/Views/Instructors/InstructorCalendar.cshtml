@model IEnumerable<ScheduleCreator.Models.Instructor>

@{
    ViewBag.Title = "Instructor Calendar";
}
<link rel="stylesheet" type="text/css" href="~/Content/easycal.css">
<script type="text/javascript" src="~/Content/jquery.min.js"></script>
<script type="text/javascript" src="~/Content/underscore.min.js"></script>
<script type="text/javascript" src="~/Content/moment.min.js"></script>
<script type="text/javascript" src="~/Content/easycal.js"></script>

<h2>Instructor Calendar</h2>

<div class="col-lg-2" id="calendar-nav">


    @foreach (var Instructor in Model)
    {
        if (true)
        {
            <input type="radio" name="instructor" value="@Instructor.instructor_id" /> @(Instructor.instructorLastName + ", " + Instructor.instructorFirstName)<br />
        }
    }
    <div class="form-group">
            <button id="update-instructors" onclick="generateCalendar()" class="btn btn-default" />
    </div>
</div>
<div class="col-lg-10">
    <div class="mycal" style="width:100%;"></div>
    <script>
        var temp = $('.mycal');

        function generateCalendar() {
            //temp.empty();
            temp.easycal({
                startDate: '@Model.First().Sections.First().courseStartTime.ToString("dd-MM-yyyy")', // OR 31/10/2104
                timeFormat: 'hh:mm a',
                columnDateFormat: 'ddd',
                minTime: '06:00:00',
                maxTime: '23:00:00',
                slotDuration: 30,
                timeGranularity: 15,

                dayClick: function (el, startTime) {
                    alert('Slot selected: ' + startTime);
                },
                eventClick: function (eventId) {
                    alert('Event was clicked with id: ' + eventId);
                },

                events: GenerateEvents(),

                overlapColor: '#F00',
                overlapTextColor: '#FFF',
                overlapTitle: 'Multiple'
            });

            temp.easycal('Refresh');
        }

function GenerateEvents() {
	var n = $('input[name=instructor]:checked').val();
	var myArray = [];
	var temp;
	@foreach(var Instructor in Model){
        <text>
		if(n == @Instructor.instructor_id.ToString())
        {
        </text>
        foreach(var Section in Instructor.Sections)
        {
            foreach (char day in Section.daysTaught)
            {
                int daysToAdd = 0;
                switch (day)
                {
                    case 'm':
                    case 'M':
                        daysToAdd = 0;
                        break;
                    case 't':
                    case 'T':
                        daysToAdd = 1;
                        break;
                    case 'w':
                    case 'W':
                        daysToAdd = 2;
                        break;
                    case 'r':
                    case 'R':
                        daysToAdd = 3;
                        break;
                    case 'f':
                    case 'F':
                        daysToAdd = 4;
                        break;
                    case 's':
                    case 'S':
                        daysToAdd = 5;
                        break;
                }
                <text>
                temp = {
                    id: '@Section.section_id',
					title: '@Section.coursePrefix @Section.courseNumber',
					start: '@Section.courseStartTime.AddDays(daysToAdd).ToString("dd-MM-yyyy HH:mm:ss")',
					end: '@Section.courseEndTime.AddDays(daysToAdd).ToString("dd-MM-yyyy HH:mm:ss")',
		            backgroundColor: '#492365',
					textColor: '#FFF'

                }
                myArray.push(temp);
                </text>
            }
        }
        <text>
        }
        </text>
	}
	return myArray;
}
    </script>
</div>
